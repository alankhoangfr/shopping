{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\AlankHoang\\\\Desktop\\\\freecodeacademy\\\\shoppingbasket\\\\client\\\\src\\\\components\\\\Map.js\";\nimport React, { Component } from 'react';\nimport { withGoogleMap, GoogleMap, withScriptjs, Marker } from \"react-google-maps\";\nimport Geocode from \"react-geocode\";\nimport Autocomplete from 'react-google-autocomplete';\nimport basket from \"../image/basket.png\";\nimport basketSelected from \"../image/basketSelected.png\";\nGeocode.setApiKey('AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI');\nGeocode.enableDebug();\nexport class Map extends Component {\n  constructor(props) {\n    super(props);\n\n    this.updating_marker = () => {\n      console.log(\"updating marker>\");\n\n      if (this.state.moving === true) {\n        var markers1 = this.insideBound_bound(this.state.markers, this.state.bound);\n        this.setState({\n          markers1: markers1,\n          moving: false,\n          input: false,\n          maploading: false\n        });\n      } else {\n        markers1 = this.insideBound(this.state.markers, this.state.movePosition);\n        this.setState({\n          markers1: markers1,\n          moving: false,\n          input: false,\n          maploading: false\n        });\n      }\n    };\n\n    this.check_markers1 = (array1, array2) => {\n      var arr1 = [];\n      var arr2 = [];\n      array1.map(elem => {\n        return;\n        arr1.push(elem.photo_id);\n      });\n      array2.map(elem => {\n        return;\n        arr2.push(elem.photo_id);\n      });\n\n      if (arr1.sort().toString() == arr2.sort().toString()) {\n        return true;\n      } else {\n        return false;\n      }\n    };\n\n    this.onPlaceSelected = (place, event) => {\n      console.log(place);\n\n      if (place.name !== undefined) {\n        Geocode.fromAddress(place.name).then(response => {\n          const _response$results$0$g = response.results[0].geometry.location,\n                lat = _response$results$0$g.lat,\n                lng = _response$results$0$g.lng;\n          console.log(lat, lng);\n          var markers1 = this.insideBound(this.state.markers, response.results[0].geometry.location);\n\n          if (lat === undefined) {\n            return null;\n          }\n\n          this.setState({\n            mapPosition: {\n              lat: lat,\n              lng: lng\n            },\n            markerPosition: {\n              lat: lat,\n              lng: lng\n            },\n            movePosition: {\n              lat: lat,\n              lng: lng\n            },\n            zoom: 12,\n            markers1: markers1,\n            input: true,\n            moving: false\n          });\n        });\n      } else {\n        latValue = place.geometry.location.lat(), lngValue = place.geometry.location.lng();\n        var markers1 = this.insideBound(this.state.markers, place.geometry.location); // Set these values in the state.\n\n        this.setState({\n          mapPosition: {\n            lat: latValue,\n            lng: lngValue\n          },\n          markerPosition: {\n            lat: latValue,\n            lng: lngValue\n          },\n          movePosition: {\n            lat: latValue,\n            lng: lngValue\n          },\n          zoom: 12,\n          markers1: markers1,\n          input: true,\n          moving: false\n        });\n      }\n\n      this.props.markerSelected(\"\");\n      return;\n    };\n\n    this.mapmoved = () => {\n      console.log(\"mapMoved:\" + JSON.stringify(this.state.map.getBounds()));\n      var markers1 = this.insideBound_bound(this.state.markers, this.state.map.getBounds());\n      this.setState({\n        bound: this.state.map.getBounds(),\n        movePosition: {\n          lat: this.state.map.getCenter().lat(),\n          lng: this.state.map.getCenter().lng()\n        },\n        mapPosition: {\n          lat: this.state.map.getCenter().lat(),\n          lng: this.state.map.getCenter().lng()\n        },\n        markers1: markers1,\n        moving: true\n      });\n    };\n\n    this.maploaded = mapRef => {\n      console.log(\"maploaded\");\n\n      if (!mapRef) {\n        return;\n      }\n\n      this.setState({\n        map: mapRef,\n        maploading: true\n      });\n    };\n\n    this.onZoom = () => {\n      console.log(\"zoom:\" + this.state.map.getCenter(), this.state.map.getZoom());\n      var markers1 = this.insideBound_bound(this.state.markers, this.state.map.getBounds());\n      this.setState({\n        bound: this.state.map.getBounds(),\n        movePosition: {\n          lat: this.state.map.getCenter().lat(),\n          lng: this.state.map.getCenter().lng()\n        },\n        mapPosition: {\n          lat: this.state.map.getCenter().lat(),\n          lng: this.state.map.getCenter().lng()\n        },\n        markers1: markers1,\n        zoom: this.state.map.getZoom(),\n        moving: true\n      });\n    };\n\n    this.insideBound = (shops, center) => {\n      if (center != null && shops != null) {\n        var result = [];\n        shops.map(shop => {\n          if (shop.lat > center.lat - 0.2 && shop.lat < center.lat + 0.2 && shop.lng > center.lng - 0.2 && shop.lng < center.lng + 0.2) {\n            result.push(shop);\n          }\n\n          return;\n        });\n        console.log(result, \"lets look center\", center, shops);\n        this.props.markersInBound(result);\n        return result;\n      } else {\n        return [];\n      }\n    };\n\n    this.insideBound_bound = (shops, bound) => {\n      if (bound != null && shops != null) {\n        var result = [];\n        shops.map(shop => {\n          if (shop.lat > bound.na.j && shop.lat < bound.na.l && shop.lng > bound.ia.j && shop.lng < bound.ia.l) {\n            result.push(shop);\n          }\n        });\n        console.log(result, \"lets look bound\", bound, shops);\n        this.props.markersInBound(result);\n        return result;\n      } else {\n        return [];\n      }\n\n      return;\n    };\n\n    this.onDblClick = (marker, event) => {\n      var mark = this.state.markers1.filter(mark => {\n        return mark.photo_id === marker;\n      });\n      mark = mark[0];\n      this.props.markerSelected(mark);\n      this.setState({\n        markerSelected: mark.photo_id\n      });\n    };\n\n    this.iconBasket = marker => {\n      let icon;\n\n      if (this.state.markerSelected === marker.photo_id) {\n        icon = basketSelected;\n      } else {\n        icon = basket;\n      }\n\n      return icon;\n    };\n\n    this.state = {\n      bound: null,\n      input: \"\",\n      mapPosition: {\n        lat: this.props.center.lat,\n        lng: this.props.center.lng\n      },\n      markerPosition: {\n        lat: this.props.center.lat,\n        lng: this.props.center.lng\n      },\n      movePosition: {\n        lat: this.props.center.lat,\n        lng: this.props.center.lng\n      },\n      map: null,\n      markers: [{\n        photo_id: 0,\n        lat: -33.78,\n        lng: 151.2,\n        name: \"add1\",\n        address: \"asdfddfd\",\n        score: \"50.32\",\n        details: \"details\"\n      }, {\n        photo_id: 10,\n        lat: -33.79,\n        lng: 151.1,\n        name: \"add22\",\n        address: \"asdfd\",\n        score: \"54.32\",\n        details: \"details\"\n      }, {\n        photo_id: 2,\n        lat: -33.785,\n        lng: 151.23,\n        name: \"add3\",\n        address: \"asdfd\",\n        score: \"20.32\",\n        details: \"details\"\n      }, {\n        photo_id: 5,\n        lat: -31.95,\n        lng: 115.8605,\n        name: \"add4\",\n        address: \"asdfd\",\n        score: \"30.32\",\n        details: \"details\"\n      }, {\n        photo_id: 1,\n        lat: -34.070587,\n        lng: 150.791252,\n        name: \"add2\",\n        address: \"asdfd\",\n        score: \"35.32\",\n        details: \"details\"\n      }],\n      markers1: [],\n      zoom: 10,\n      moving: false,\n      maploading: false,\n      markerSelected: \"\"\n    };\n  }\n\n  componentDidMount() {\n    this.updating_marker();\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    console.log(\"should Componeent update\", nextState, this.state);\n\n    if (this.check_markers1(nextState.markers1, this.state.markers1) === false) {\n      console.log(\"change\");\n      return true;\n    } else if (nextState.input === true) {\n      console.log(\"change position\");\n      return true;\n    } else if (this.check_markers1(nextState.markers1, this.state.markers1) === true) {\n      console.log(\"no change\");\n      return false;\n    }\n  }\n\n  componentDidUpdate(prevProps, prevState, snapshot) {\n    console.log(\"componentDidUpdate\", prevState);\n    this.updating_marker();\n  }\n\n  render() {\n    console.log(this.state, \"rendering\");\n    const AsyncMap = withScriptjs(withGoogleMap(props => React.createElement(GoogleMap, {\n      google: this.props.google,\n      ref: this.maploaded,\n      zoom: this.state.zoom,\n      defaultCenter: {\n        lat: this.props.lat,\n        lng: this.props.lng\n      },\n      center: {\n        lat: this.state.mapPosition.lat,\n        lng: this.state.mapPosition.lng\n      },\n      onDragEnd: this.mapmoved,\n      onZoomChanged: this.onZoom,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253\n      },\n      __self: this\n    }, React.createElement(Autocomplete, {\n      style: {\n        width: '200%',\n        height: '40px',\n        paddingLeft: '16px',\n        margin: \"2px auto 20px auto\"\n      },\n      onPlaceSelected: this.onPlaceSelected,\n      types: ['(regions)'],\n      placeholder: \"Enter and select location\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 262\n      },\n      __self: this\n    }), React.createElement(Marker, {\n      draggable: true,\n      position: {\n        lat: this.state.markerPosition.lat,\n        lng: this.state.markerPosition.lng\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 273\n      },\n      __self: this\n    }), this.state.markers1.map(marker => {\n      console.log(this.state.markerSelected, \"markerselected\", marker.photo_id, \"are they the same\");\n      return React.createElement(Marker, {\n        key: marker.photo_id,\n        position: {\n          lat: marker.lat,\n          lng: marker.lng\n        },\n        icon: this.iconBasket(marker),\n        onDblClick: this.onDblClick.bind(this, marker.photo_id),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 280\n        },\n        __self: this\n      });\n    }))));\n    let map;\n    map = React.createElement(\"div\", {\n      style: {\n        width: \"100%\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 294\n      },\n      __self: this\n    }, React.createElement(AsyncMap, {\n      googleMapURL: \"https://maps.googleapis.com/maps/api/js?key=AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI&libraries=places\",\n      loadingElement: React.createElement(\"div\", {\n        style: {\n          height: \"100%\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 298\n        },\n        __self: this\n      }),\n      containerElement: React.createElement(\"div\", {\n        style: {\n          height: this.props.height,\n          display: \"flex\",\n          flexDirection: \"column-reverse\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 301\n        },\n        __self: this\n      }),\n      mapElement: React.createElement(\"div\", {\n        style: {\n          height: \"100%\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 306\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295\n      },\n      __self: this\n    }));\n    return React.createElement(React.Fragment, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 312\n      },\n      __self: this\n    }, map);\n  }\n\n}\nexport default Map;","map":{"version":3,"sources":["C:\\Users\\AlankHoang\\Desktop\\freecodeacademy\\shoppingbasket\\client\\src\\components\\Map.js"],"names":["React","Component","withGoogleMap","GoogleMap","withScriptjs","Marker","Geocode","Autocomplete","basket","basketSelected","setApiKey","enableDebug","Map","constructor","props","updating_marker","console","log","state","moving","markers1","insideBound_bound","markers","bound","setState","input","maploading","insideBound","movePosition","check_markers1","array1","array2","arr1","arr2","map","elem","push","photo_id","sort","toString","onPlaceSelected","place","event","name","undefined","fromAddress","then","response","results","geometry","location","lat","lng","mapPosition","markerPosition","zoom","latValue","lngValue","markerSelected","mapmoved","JSON","stringify","getBounds","getCenter","maploaded","mapRef","onZoom","getZoom","shops","center","result","shop","markersInBound","na","j","l","ia","onDblClick","marker","mark","filter","iconBasket","icon","address","score","details","componentDidMount","shouldComponentUpdate","nextProps","nextState","componentDidUpdate","prevProps","prevState","snapshot","render","AsyncMap","google","width","height","paddingLeft","margin","bind","display","flexDirection"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { withGoogleMap, GoogleMap, withScriptjs, Marker  } from \"react-google-maps\";\r\nimport Geocode from \"react-geocode\"\r\nimport Autocomplete from 'react-google-autocomplete';\r\nimport basket from \"../image/basket.png\"\r\nimport basketSelected from \"../image/basketSelected.png\"\r\n\r\nGeocode.setApiKey('AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI');\r\nGeocode.enableDebug();\r\n\r\n\r\nexport class Map extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.state = {\r\n\t\t\tbound:null,\r\n\t\t\tinput:\"\",\r\n\t\t\tmapPosition:{\r\n\t\t\t\tlat: this.props.center.lat,\r\n\t\t\t\tlng: this.props.center.lng\r\n\t\t\t},\r\n\t\t\tmarkerPosition:{\r\n\t\t\t\tlat:this.props.center.lat,\r\n\t\t\t\tlng:this.props.center.lng\r\n\t\t\t},\r\n\t\t\tmovePosition:{\r\n\t\t\t\tlat:this.props.center.lat,\r\n\t\t\t\tlng:this.props.center.lng\t\t\r\n\t\t\t},\r\n\t\t\tmap:null,\r\n\t\t\tmarkers:[{photo_id:0,lat: -33.78, lng: 151.2,name:\"add1\",address:\"asdfddfd\",score:\"50.32\",details:\"details\"},\r\n\t\t\t\t{photo_id:10,lat: -33.79, lng: 151.1,name:\"add22\",address:\"asdfd\",score:\"54.32\",details:\"details\"},\r\n\t\t\t\t{photo_id:2,lat: -33.785, lng: 151.23,name:\"add3\",address:\"asdfd\",score:\"20.32\",details:\"details\"},\r\n\t\t\t\t{photo_id:5,lat: -31.95, lng: 115.8605,name:\"add4\",address:\"asdfd\",score:\"30.32\",details:\"details\"},\r\n\t\t\t\t{photo_id:1,lat: -34.070587, lng: 150.791252,name:\"add2\",address:\"asdfd\",score:\"35.32\",details:\"details\"}],\r\n\t\t\tmarkers1:[],\r\n\t\t\tzoom:10,\r\n\t\t\tmoving:false,\r\n\t\t\tmaploading:false,\r\n\t\t\tmarkerSelected:\"\",\r\n\t\t}\r\n\t}\r\n\tcomponentDidMount(){\r\n\t\tthis.updating_marker()\r\n\t}\r\n\tupdating_marker = ()=>{\r\n\t\tconsole.log(\"updating marker>\")\r\n\t\tif (this.state.moving===true){\r\n\t\t\tvar markers1 = this.insideBound_bound(this.state.markers,this.state.bound)\r\n\t\t\tthis.setState({\r\n\t\t\t\tmarkers1:markers1,\r\n\t\t\t\tmoving:false,\r\n\t\t\t\tinput:false,\r\n\t\t\t\tmaploading:false\r\n\t\t\t})\r\n\t\t}else{\r\n\t\t\tmarkers1 = this.insideBound(this.state.markers,this.state.movePosition)\r\n\t\t\tthis.setState({\r\n\t\t\t\tmarkers1:markers1,\r\n\t\t\t\tmoving:false,\r\n\t\t\t\tinput:false,\r\n\t\t\t\tmaploading:false,\r\n\t\t\t})\t\t\r\n\t\t}\r\n\t\t}\r\n\tshouldComponentUpdate( nextProps, nextState ){\t\r\n\t\tconsole.log(\"should Componeent update\", nextState, this.state)\r\n\t\tif (this.check_markers1(nextState.markers1,this.state.markers1)===false){\r\n\t\t\tconsole.log(\"change\")\r\n\t\t\treturn true\r\n\t\t}\t\t\r\n\t\telse if(nextState.input===true){\r\n\t\t\tconsole.log(\"change position\")\r\n\t\t\treturn true\r\n\t\t}\r\n\t\telse if (this.check_markers1(nextState.markers1,this.state.markers1)===true){\r\n\t\t\tconsole.log(\"no change\")\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\tcomponentDidUpdate(prevProps, prevState, snapshot){\r\n\t\tconsole.log(\"componentDidUpdate\",prevState)\r\n\t\tthis.updating_marker()\r\n\t}\r\n\tcheck_markers1=(array1,array2) => {\r\n\t\tvar arr1 = []\r\n\t\tvar arr2 = []\r\n\t\tarray1.map((elem)=>{\r\n\t\t\treturn\r\n\t\t\tarr1.push(elem.photo_id)\r\n\t\t})\r\n\t\tarray2.map((elem)=>{\r\n\t\t\treturn\r\n\t\t\tarr2.push(elem.photo_id)\r\n\t\t})\r\n\t\tif (arr1.sort().toString()==arr2.sort().toString()){\t\r\n\t\t\treturn true\r\n\t\t}else \r\n\t\t\t{return false}\r\n\t\t}\r\n\tonPlaceSelected = ( place,event ) => {\r\n\t\tconsole.log(place)\r\n\t\tif (place.name!==undefined){\r\n\t\t\tGeocode.fromAddress(place.name).then(\r\n\t\t\t\tresponse => {\r\n    \t\t\tconst { lat, lng } = response.results[0].geometry.location\r\n    \t\t\tconsole.log(lat, lng)\r\n    \t\t\tvar markers1 = this.insideBound(this.state.markers,response.results[0].geometry.location)\r\n    \t\t\tif (lat ===undefined){\r\n    \t\t\t\treturn null\r\n    \t\t\t}\r\n    \t\t\tthis.setState({\r\n\t\t\t\t\tmapPosition: {\r\n\t\t\t\t\t\tlat: lat,\r\n\t\t\t\t\t\tlng: lng\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmarkerPosition: {\r\n\t\t\t\t\t\tlat: lat,\r\n\t\t\t\t\t\tlng: lng\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmovePosition: {\r\n\t\t\t\t\t\tlat: lat,\r\n\t\t\t\t\t\tlng: lng\r\n\t\t\t\t},\r\n\t\t\t\t\tzoom:12,\r\n\t\t\t\t\tmarkers1:markers1,\r\n\t\t\t\t\tinput:true,\r\n\t\t\t\t\tmoving:false,\r\n\t\t\t})\r\n    \t\t})\r\n\t\t}\r\n\t\telse{\r\n\t\t\tlatValue = place.geometry.location.lat(),\r\n\t\t\tlngValue = place.geometry.location.lng();\r\n\t\t\tvar markers1 = this.insideBound(this.state.markers,place.geometry.location)\r\n\t\t\t// Set these values in the state.\r\n\t\t\tthis.setState({\r\n\t\t\t\tmapPosition: {\r\n\t\t\t\t\tlat: latValue,\r\n\t\t\t\t\tlng: lngValue\r\n\t\t\t\t},\r\n\t\t\t\tmarkerPosition: {\r\n\t\t\t\t\tlat: latValue,\r\n\t\t\t\t\tlng: lngValue\r\n\t\t\t\t},\r\n\t\t\t\tmovePosition: {\r\n\t\t\t\t\tlat: latValue,\r\n\t\t\t\t\tlng: lngValue\r\n\t\t\t\t},\r\n\t\t\t\tzoom:12,\r\n\t\t\t\tmarkers1:markers1,\r\n\t\t\t\tinput:true,\r\n\t\t\t\tmoving:false,\r\n\t\t\t})\r\n\t\t}\r\n\tthis.props.markerSelected(\"\")\r\n\treturn\r\n\t};\r\n\tmapmoved=()=>{\r\n\t\tconsole.log(\"mapMoved:\"+JSON.stringify(this.state.map.getBounds()))\r\n\t\tvar markers1 = this.insideBound_bound(this.state.markers,this.state.map.getBounds())\r\n\t\tthis.setState({\r\n\t\t\tbound:this.state.map.getBounds(),\r\n\t\t\tmovePosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\t\t\tmapPosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\t\t\tmarkers1:markers1 ,\r\n\t\t\tmoving:true\t\r\n\t\t})\r\n\t}\r\n\tmaploaded=(mapRef)=>{\r\n\t\tconsole.log(\"maploaded\")\r\n\t\tif(!mapRef){\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tmap:mapRef,\r\n\t\t\tmaploading:true})\t\r\n\t}\r\n\tonZoom = ()=>{\r\n\t\tconsole.log(\"zoom:\"+this.state.map.getCenter(),this.state.map.getZoom())\r\n\t\tvar markers1 = this.insideBound_bound(this.state.markers,this.state.map.getBounds())\r\n\t\tthis.setState({\r\n\t\t\tbound:this.state.map.getBounds(),\r\n\t\t\tmovePosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\t\t\tmapPosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\t\t\tmarkers1:markers1,\r\n\t\t\tzoom:this.state.map.getZoom(),\r\n\t\t\tmoving:true\t\r\n\t\t})\r\n\t}\r\n\tinsideBound = (shops,center)=>{\r\n\t\tif (center!=null&&shops!=null){\r\n\t\t\tvar result = []\r\n\t\t\tshops.map((shop)=>{\r\n\t\t\t\tif (shop.lat>center.lat-0.2 && shop.lat<center.lat+0.2 && shop.lng>center.lng-0.2 && shop.lng<center.lng+0.2){\r\n\t\t\t\t\tresult.push(shop)}\t\r\n\t\t\t\treturn\r\n\t\t\t})\r\n\t\t\tconsole.log(result,\"lets look center\",center,shops)\t\r\n\t\t\tthis.props.markersInBound(result)\t\t\r\n\t\t\treturn result\t\t\t\r\n\t\t}else{return []}\t\t\r\n\t}\r\n\tinsideBound_bound = (shops,bound)=>{\r\n\t\tif (bound!=null&&shops!=null){\r\n\t\t\tvar result = []\t\r\n\t\t\tshops.map((shop)=>{\r\n\t\t\t\tif (shop.lat>bound.na.j && shop.lat<bound.na.l && shop.lng>bound.ia.j && shop.lng<bound.ia.l){\r\n\t\t\t\t\tresult.push(shop)}\t\r\n\t\t\t})\r\n\t\t\tconsole.log(result,\"lets look bound\",bound,shops)\t\t\r\n\t\t\tthis.props.markersInBound(result)\t\t\r\n\t\t\treturn result\t\t\t\r\n\t\t}else{return []}\r\n\t\treturn\r\n\t\t\r\n\t}\r\n\tonDblClick = (marker,event)=>{\t\r\n\t\tvar mark = this.state.markers1.filter((mark)=>{\r\n\t\t\treturn mark.photo_id=== marker\r\n\t\t})\r\n\t\tmark = mark[0]\r\n\t\tthis.props.markerSelected(mark)\r\n\t\tthis.setState({markerSelected:mark.photo_id})\r\n\t} \r\n\ticonBasket = (marker)=>{\r\n\t\tlet icon\r\n\t\tif (this.state.markerSelected===marker.photo_id){\r\n\t\t\t\ticon = basketSelected\r\n\t\t\t}else{\r\n\t\t\t\ticon = basket\r\n\t\t\t}\r\n\t\treturn icon\t\r\n\t}\t  \t\t\r\n\trender() {\r\n\tconsole.log(this.state,\"rendering\")\r\n\t\r\n\tconst AsyncMap = withScriptjs(\r\n\t\twithGoogleMap(\r\n\t\t\tprops => (\r\n\t\t\t\t<GoogleMap \r\n\t\t\t\tgoogle={this.props.google}\r\n\t\t\t\tref = {this.maploaded}\r\n\t\t\t\tzoom={this.state.zoom}\r\n\t\t\t\tdefaultCenter={{ lat: this.props.lat, lng: this.props.lng }}\r\n\t\t\t\tcenter={{ lat: this.state.mapPosition.lat, lng: this.state.mapPosition.lng }}\r\n\t\t\t\tonDragEnd={this.mapmoved}\r\n\t\t\t\tonZoomChanged = {this.onZoom}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Autocomplete\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\twidth: '200%',\r\n\t\t\t\t\t\theight: '40px',\r\n\t\t\t\t\t\tpaddingLeft: '16px',\r\n\t\t\t\t\t\tmargin:\"2px auto 20px auto\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonPlaceSelected={ this.onPlaceSelected }\r\n\t\t\t\t\t\ttypes={['(regions)']}\r\n\t\t\t\t\t\tplaceholder={\"Enter and select location\"}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<Marker \r\n\t\t\t\t\t\tdraggable={true}\r\n\t\t\t\t\t\tposition={{ lat: this.state.markerPosition.lat, lng: this.state.markerPosition.lng }}\r\n\t\t\t\t\t/>\r\n  \t\t\t\t\t{this.state.markers1.map((marker) => {\t\t\t\t\r\n  \t\t\t\t\t\tconsole.log(this.state.markerSelected,\"markerselected\",marker.photo_id,\"are they the same\")\r\n\t\t\t\t\t\treturn( \r\n\t    \t\t\t\t\t<Marker\r\n\t      \t\t\t\t\t\tkey={marker.photo_id}\r\n\t      \t\t\t\t\t\tposition={{ lat: marker.lat, lng: marker.lng }}\r\n\t      \t\t\t\t\t\ticon ={this.iconBasket(marker)}\r\n\t      \t\t\t\t\t\tonDblClick = {this.onDblClick.bind(this,marker.photo_id)}\r\n\t    \t\t\t\t\t/>\r\n\t\t\t\t\t\t)\r\n  \t\t\t\t\t\t\r\n    \t\t\t\t})}\t\t\t\t\r\n\t\t\t\t</GoogleMap>\r\n\t\t\t)\r\n\t\t)\r\n\t)\r\n\tlet map\r\n\tmap =  <div style={{width:\"100%\"}} >\r\n\t\t\t<AsyncMap\r\n\t\t\t\tgoogleMapURL= \"https://maps.googleapis.com/maps/api/js?key=AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI&libraries=places\"\r\n\t\t\t\tloadingElement={\r\n\t\t\t\t <div style={{ height: `100%` }} />\r\n\t\t\t\t}\r\n\t\t\t\tcontainerElement={\r\n\t\t\t\t <div style={{ height: this.props.height,\r\n  \t\t\t\t\t\t\t\tdisplay: \"flex\",\r\n  \t\t\t\t\t\t\t\tflexDirection: \"column-reverse\"}} />\r\n\t\t\t\t}\r\n\t\t\t\tmapElement={\r\n\t\t\t\t <div style={{ height: `100%` }} />\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\treturn (\r\n\t\t<React.Fragment>\r\n\t\t\t{map}\r\n\t\t</React.Fragment> \r\n\t)\r\n  }\r\n}\r\n\r\nexport default Map"]},"metadata":{},"sourceType":"module"}