{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\AlankHoang\\\\Desktop\\\\freecodeacademy\\\\shoppingBasket\\\\client\\\\src\\\\components\\\\Map.js\";\nimport React, { Component } from 'react';\nimport { withGoogleMap, GoogleMap, withScriptjs, InfoWindow, Marker } from \"react-google-maps\";\nimport Geocode from \"react-geocode\";\nimport Autocomplete from 'react-google-autocomplete';\nimport basket from \"../image/basket.png\";\nGeocode.setApiKey('AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI');\nGeocode.enableDebug();\nexport class Map extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      bound: null,\n      mapPosition: {\n        lat: this.props.center.lat,\n        lng: this.props.center.lng\n      },\n      markerPosition: {\n        lat: this.props.center.lat,\n        lng: this.props.center.lng\n      },\n      movePosition: {\n        lat: this.props.center.lat,\n        lng: this.props.center.lng\n      },\n      map: null,\n      markers: [{\n        photo_id: 0,\n        lat: -33.78,\n        lng: 151.2,\n        name: \"add1\"\n      }, {\n        photo_id: 10,\n        lat: -33.79,\n        lng: 151.1,\n        name: \"add22\"\n      }, {\n        photo_id: 2,\n        lat: -33.785,\n        lng: 151.23,\n        name: \"add3\"\n      }, {\n        photo_id: 5,\n        lat: -31.95,\n        lng: 115.8605,\n        name: \"add3\"\n      }],\n      markers1: [],\n      zoom: 10\n    };\n\n    this.check_markers1 = (array1, array2) => {\n      var arr1 = [];\n      var arr2 = [];\n      array1.map(elem => {\n        arr1.push(elem.photo_id);\n      });\n      array2.map(elem => {\n        arr2.push(elem.photo_id);\n      });\n\n      if (arr1.sort().toString() == arr2.sort().toString()) {\n        return true;\n      } else {\n        return false;\n      }\n    };\n\n    this.onPlaceSelected = (place, event) => {\n      console.log(place);\n\n      if (place.name !== undefined) {\n        Geocode.fromAddress(place.name).then(response => {\n          const _response$results$0$g = response.results[0].geometry.location,\n                lat = _response$results$0$g.lat,\n                lng = _response$results$0$g.lng;\n          console.log(lat, lng);\n          var markers1 = this.insideBound(this.state.markers, response.results[0].geometry.location);\n\n          if (lat === undefined) {\n            return null;\n          }\n\n          this.setState({\n            mapPosition: {\n              lat: lat,\n              lng: lng\n            },\n            markerPosition: {\n              lat: lat,\n              lng: lng\n            },\n            movePosition: {\n              lat: lat,\n              lng: lng\n            },\n            zoom: 12,\n            markers1: markers1\n          });\n        });\n      } else {\n        const name = place.formatted_name,\n              latValue = place.geometry.location.lat(),\n              lngValue = place.geometry.location.lng();\n        var markers1 = this.insideBound(this.state.markers, place.geometry.location); // Set these values in the state.\n\n        this.setState({\n          mapPosition: {\n            lat: latValue,\n            lng: lngValue\n          },\n          markerPosition: {\n            lat: latValue,\n            lng: lngValue\n          },\n          movePosition: {\n            lat: latValue,\n            lng: lngValue\n          },\n          zoom: 12,\n          markers1: markers1\n        });\n      }\n\n      return;\n    };\n\n    this.mapmoved = () => {\n      console.log(\"mapMoved:\" + JSON.stringify(this.state.map.getCenter()));\n      var markers1 = this.insideBound(this.state.markers, this.state.movePosition);\n      this.setState({\n        bound: this.state.map.getBounds(),\n        movePosition: {\n          lat: this.state.map.getCenter().lat(),\n          lng: this.state.map.getCenter().lng()\n        },\n        mapPosition: {\n          lat: this.state.map.getCenter().lat(),\n          lng: this.state.map.getCenter().lng()\n        },\n        markers1: markers1\n      });\n    };\n\n    this.maploaded = mapRef => {\n      console.log(\"maploaded\");\n\n      if (!mapRef) {\n        return;\n      }\n\n      this.setState({\n        map: mapRef\n      });\n    };\n\n    this.onZoom = () => {\n      console.log(\"zoom:\" + this.state.map.getBounds(), this.state.map.getZoom());\n      this.setState({\n        bound: this.state.map.getBounds(),\n        movePosition: {\n          lat: this.state.map.getCenter().lat(),\n          lng: this.state.map.getCenter().lng()\n        },\n        zoom: this.state.map.getZoom()\n      });\n    };\n\n    this.insideBound = (shops, center) => {\n      if (center != null && shops != null) {\n        var result = [];\n        shops.map(shop => {\n          if (shop.lat > center.lat - 0.2 && shop.lat < center.lat + 0.2 && shop.lng > center.lng - 0.2 && shop.lng < center.lng + 0.2) {\n            result.push(shop);\n          }\n        });\n        console.log(result, \"lets look\", center, shops);\n        return result;\n      } else {\n        return [];\n      }\n    };\n  }\n\n  getSnapshotBeforeUpdate(prevProps, prevState) {\n    console.log(\"get snap shot\", prevState, this.state);\n  }\n\n  shouldComponentUpdate(nextProps, nextState) {\n    console.log(\"should Componeent update\", nextState, this.state);\n\n    if (this.check_markers1(nextState.markers1, this.state.markers1) == false) {\n      console.log(\"change\");\n      return true;\n    } else if (this.check_markers1(nextState.markers1, this.state.markers1) == false) {\n      console.log(\"no change\");\n      return false;\n    }\n\n    if (this.state.map != null) {\n      if (props.center.lat !== this.state.mapPosition.lat) {\n        return true;\n      }\n    } else if (nextState.mapPosition.lat !== this.state.mapPosition.lat) {\n      return true;\n    } else if (this.state.mapPosition.lat === nextState.mapPosition.lat) {\n      return false;\n    }\n  }\n\n  render() {\n    console.log(this.state);\n    const AsyncMap = withScriptjs(withGoogleMap(props => React.createElement(GoogleMap, {\n      google: this.props.google,\n      ref: this.maploaded,\n      zoom: this.state.zoom,\n      defaultCenter: {\n        lat: this.props.lat,\n        lng: this.props.lng\n      },\n      center: {\n        lat: this.state.mapPosition.lat,\n        lng: this.state.mapPosition.lng\n      },\n      onDragEnd: this.mapmoved,\n      onZoomChanged: this.onZoom,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, React.createElement(Marker, {\n      draggable: true,\n      position: {\n        lat: this.state.markerPosition.lat,\n        lng: this.state.markerPosition.lng\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202\n      },\n      __self: this\n    }), this.insideBound(this.state.markers, this.state.movePosition).map(marker => {\n      var result = this.insideBound(this.state.markers, this.state.movePosition);\n      this.setState({\n        markers1: result\n      });\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 210\n        },\n        __self: this\n      }, React.createElement(Marker, {\n        key: marker.photo_id,\n        position: {\n          lat: marker.lat,\n          lng: marker.lng\n        },\n        icon: basket,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211\n        },\n        __self: this\n      }));\n    }), React.createElement(Autocomplete, {\n      style: {\n        width: '200%',\n        height: '40px',\n        paddingLeft: '16px',\n        marginTop: '2px',\n        marginBottom: '100px'\n      },\n      onPlaceSelected: this.onPlaceSelected,\n      types: ['(regions)'],\n      placeholder: \"Enter and select location\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220\n      },\n      __self: this\n    }))));\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 242\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 243\n      },\n      __self: this\n    }, React.createElement(\"h1\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 244\n      },\n      __self: this\n    }, \"Search for the Supermarkets near you\")), React.createElement(\"div\", {\n      style: {\n        width: \"500px\"\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249\n      },\n      __self: this\n    }, React.createElement(AsyncMap, {\n      googleMapURL: \"https://maps.googleapis.com/maps/api/js?key=AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI&libraries=places\",\n      loadingElement: React.createElement(\"div\", {\n        style: {\n          height: \"100%\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 254\n        },\n        __self: this\n      }),\n      containerElement: React.createElement(\"div\", {\n        style: {\n          height: this.props.height\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 257\n        },\n        __self: this\n      }),\n      mapElement: React.createElement(\"div\", {\n        style: {\n          height: \"100%\"\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 260\n        },\n        __self: this\n      }),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 251\n      },\n      __self: this\n    })));\n  }\n\n}\nexport default Map;","map":{"version":3,"sources":["C:\\Users\\AlankHoang\\Desktop\\freecodeacademy\\shoppingBasket\\client\\src\\components\\Map.js"],"names":["React","Component","withGoogleMap","GoogleMap","withScriptjs","InfoWindow","Marker","Geocode","Autocomplete","basket","setApiKey","enableDebug","Map","state","bound","mapPosition","lat","props","center","lng","markerPosition","movePosition","map","markers","photo_id","name","markers1","zoom","check_markers1","array1","array2","arr1","arr2","elem","push","sort","toString","onPlaceSelected","place","event","console","log","undefined","fromAddress","then","response","results","geometry","location","insideBound","setState","formatted_name","latValue","lngValue","mapmoved","JSON","stringify","getCenter","getBounds","maploaded","mapRef","onZoom","getZoom","shops","result","shop","getSnapshotBeforeUpdate","prevProps","prevState","shouldComponentUpdate","nextProps","nextState","render","AsyncMap","google","marker","width","height","paddingLeft","marginTop","marginBottom"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\r\nimport { withGoogleMap, GoogleMap, withScriptjs, InfoWindow, Marker  } from \"react-google-maps\";\r\nimport Geocode from \"react-geocode\"\r\nimport Autocomplete from 'react-google-autocomplete';\r\nimport basket from \"../image/basket.png\"\r\n\r\nGeocode.setApiKey('AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI');\r\nGeocode.enableDebug();\r\n\r\n\r\nexport class Map extends Component {\r\n\tstate = {\r\n\t\tbound:null,\r\n\t\tmapPosition:{\r\n\t\t\tlat: this.props.center.lat,\r\n\t\t\tlng: this.props.center.lng\r\n\t\t},\r\n\t\tmarkerPosition:{\r\n\t\t\tlat:this.props.center.lat,\r\n\t\t\tlng:this.props.center.lng\r\n\t\t},\r\n\t\tmovePosition:{\r\n\t\t\tlat:this.props.center.lat,\r\n\t\t\tlng:this.props.center.lng\t\t\r\n\t\t},\r\n\t\tmap:null,\r\n\t\tmarkers:[{photo_id:0,lat: -33.78, lng: 151.2,name:\"add1\"},{photo_id:10,lat: -33.79, lng: 151.1,name:\"add22\"},\r\n\t\t\t{photo_id:2,lat: -33.785, lng: 151.23,name:\"add3\"},{photo_id:5,lat: -31.95, lng: 115.8605,name:\"add3\"}],\r\n\t\tmarkers1:[],\r\n\t\tzoom:10,\r\n\r\n\t}\r\n\r\n\tgetSnapshotBeforeUpdate(prevProps, prevState){\r\n\t\tconsole.log(\"get snap shot\", prevState,this.state)\r\n\r\n\t}\r\n\tshouldComponentUpdate( nextProps, nextState ){\t\r\n\t\tconsole.log(\"should Componeent update\", nextState, this.state)\r\n\t\tif (this.check_markers1(nextState.markers1,this.state.markers1)==false){\r\n\t\t\tconsole.log(\"change\")\r\n\t\t\treturn true\r\n\r\n\t\t}\r\n\t\telse if (this.check_markers1(nextState.markers1,this.state.markers1)==false){\r\n\t\t\tconsole.log(\"no change\")\r\n\t\t\treturn false\r\n\r\n\t\t}\r\n\t\tif (this.state.map!=null){\r\n\t\t\tif(props.center.lat!==this.state.mapPosition.lat){\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (nextState.mapPosition.lat !== this.state.mapPosition.lat ) {\r\n\t\t\treturn true\r\n\t\t} \r\n\t\telse if ( this.state.mapPosition.lat  === nextState.mapPosition.lat ){\r\n\t\t\treturn false\t\r\n\t \t}\r\n\t}\r\n\r\n\tcheck_markers1=(array1,array2) => {\r\n\t\tvar arr1 = []\r\n\t\tvar arr2 = []\r\n\t\tarray1.map((elem)=>{\r\n\t\t\tarr1.push(elem.photo_id)\r\n\t\t})\r\n\t\tarray2.map((elem)=>{\r\n\t\t\tarr2.push(elem.photo_id)\r\n\t\t})\r\n\t\tif (arr1.sort().toString()==arr2.sort().toString()){\t\r\n\t\t\treturn true\r\n\t\t}else \r\n\t\t\t{return false}\r\n\t\t}\r\n\tonPlaceSelected = ( place,event ) => {\r\n\t\tconsole.log(place)\r\n\t\tif (place.name!==undefined){\r\n\t\t\tGeocode.fromAddress(place.name).then(\r\n\t\t\t\tresponse => {\r\n    \t\t\tconst { lat, lng } = response.results[0].geometry.location\r\n    \t\t\tconsole.log(lat, lng)\r\n    \t\t\tvar markers1 = this.insideBound(this.state.markers,response.results[0].geometry.location)\r\n    \t\t\tif (lat ===undefined){\r\n    \t\t\t\treturn null\r\n    \t\t\t}\r\n    \t\t\tthis.setState({\r\n\t\t\t\t\tmapPosition: {\r\n\t\t\t\t\t\tlat: lat,\r\n\t\t\t\t\t\tlng: lng\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmarkerPosition: {\r\n\t\t\t\t\t\tlat: lat,\r\n\t\t\t\t\t\tlng: lng\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmovePosition: {\r\n\t\t\t\t\t\tlat: lat,\r\n\t\t\t\t\t\tlng: lng\r\n\t\t\t\t},\r\n\t\t\t\t\tzoom:12,\r\n\t\t\t\t\tmarkers1:markers1\r\n\r\n\t\t\t})\r\n    \t\t})\r\n\t\t}\r\n\t\telse{\r\n\t\t\tconst name = place.formatted_name,\r\n\t\t\tlatValue = place.geometry.location.lat(),\r\n\t\t\tlngValue = place.geometry.location.lng();\r\n\t\t\tvar markers1 = this.insideBound(this.state.markers,place.geometry.location)\r\n\t\t\t// Set these values in the state.\r\n\t\t\tthis.setState({\r\n\t\t\t\tmapPosition: {\r\n\t\t\t\t\tlat: latValue,\r\n\t\t\t\t\tlng: lngValue\r\n\t\t\t\t},\r\n\t\t\t\tmarkerPosition: {\r\n\t\t\t\t\tlat: latValue,\r\n\t\t\t\t\tlng: lngValue\r\n\t\t\t\t},\r\n\t\t\t\tmovePosition: {\r\n\t\t\t\t\tlat: latValue,\r\n\t\t\t\t\tlng: lngValue\r\n\t\t\t\t},\r\n\t\t\t\tzoom:12,\r\n\t\t\t\tmarkers1:markers1\r\n\t\t\t})\r\n\t\t}\r\n\treturn\r\n\r\n\t};\r\n\tmapmoved=()=>{\r\n\t\tconsole.log(\"mapMoved:\"+JSON.stringify(this.state.map.getCenter()))\r\n\t\tvar markers1 = this.insideBound(this.state.markers,this.state.movePosition)\r\n\t\tthis.setState({\r\n\t\t\tbound:this.state.map.getBounds(),\r\n\t\t\tmovePosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\t\t\tmapPosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\r\n\t\t\tmarkers1:markers1\r\n\r\n  \t\t\t\r\n\r\n\t\t})\r\n\t}\r\n\tmaploaded=(mapRef)=>{\r\n\t\tconsole.log(\"maploaded\")\r\n\t\tif(!mapRef){\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tmap:mapRef})\r\n\t\t\r\n\t}\r\n\tonZoom = ()=>{\r\n\t\tconsole.log(\"zoom:\"+this.state.map.getBounds(),this.state.map.getZoom())\r\n\t\tthis.setState({\r\n\t\t\tbound:this.state.map.getBounds(),\r\n\t\t\tmovePosition: {\r\n\t\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t\t},\r\n\t\t\tzoom:this.state.map.getZoom()\r\n\r\n\t\t})\r\n\t}\r\n\tinsideBound = (shops,center)=>{\r\n\t\tif (center!=null&&shops!=null){\r\n\t\t\tvar result = []\r\n\t\t\tshops.map((shop)=>{\r\n\t\t\t\tif (shop.lat>center.lat-0.2 && shop.lat<center.lat+0.2 && shop.lng>center.lng-0.2 && shop.lng<center.lng+0.2){\r\n\t\t\t\t\tresult.push(shop)}\t\r\n\t\t\t})\r\n\t\t\tconsole.log(result,\"lets look\",center,shops)\t\t\t\r\n\t\t\treturn result\t\t\t\r\n\t\t}else{return []}\r\n\t\t\r\n\t}\r\n\t\r\n\trender() {\r\n\tconsole.log(this.state)\r\n\t\r\n\tconst AsyncMap = withScriptjs(\r\n\t\twithGoogleMap(\r\n\t\t\tprops => (\r\n\t\t\t\t<GoogleMap \r\n\t\t\t\tgoogle={this.props.google}\r\n\t\t\t\tref = {this.maploaded}\r\n\t\t\t\tzoom={this.state.zoom}\r\n\t\t\t\tdefaultCenter={{ lat: this.props.lat, lng: this.props.lng }}\r\n\t\t\t\tcenter={{ lat: this.state.mapPosition.lat, lng: this.state.mapPosition.lng }}\r\n\t\t\t\tonDragEnd={this.mapmoved}\r\n\t\t\t\tonZoomChanged = {this.onZoom}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Marker \r\n\t\t\t\t\t\tdraggable={true}\r\n\t\t\t\t\t\tposition={{ lat: this.state.markerPosition.lat, lng: this.state.markerPosition.lng }}\r\n\t\t\t\t\t/>\r\n  \t\t\t\t\t{this.insideBound(this.state.markers,this.state.movePosition).map((marker) => {\r\n  \t\t\t\t\t\tvar result = this.insideBound(this.state.markers,this.state.movePosition)\r\n  \t\t\t\t\t\tthis.setState({markers1:result})\r\n\t\t\t\t\t\treturn( \r\n\t\t\t\t\t\t\t<div>\r\n\t    \t\t\t\t\t<Marker\r\n\t      \t\t\t\t\t\tkey={marker.photo_id}\r\n\t      \t\t\t\t\t\tposition={{ lat: marker.lat, lng: marker.lng }}\r\n\t      \t\t\t\t\t\ticon ={basket}\r\n\t    \t\t\t\t\t/>\r\n\t\t\t\t\t\t     </div>)\r\n  \t\t\t\t\t\t\r\n    \t\t\t\t})}\r\n    \t\t\t\t\r\n\t\t\t\t\t<Autocomplete\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\twidth: '200%',\r\n\t\t\t\t\t\theight: '40px',\r\n\t\t\t\t\t\tpaddingLeft: '16px',\r\n\t\t\t\t\t\tmarginTop: '2px',\r\n\t\t\t\t\t\tmarginBottom: '100px',\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonPlaceSelected={ this.onPlaceSelected }\r\n\t\t\t\t\t\ttypes={['(regions)']}\r\n\t\t\t\t\t\tplaceholder={\"Enter and select location\"}\r\n\r\n\t\t\t\t\t/>\r\n\t\t\t\t\r\n\t\t\t\t</GoogleMap>\r\n\t\t\t)\r\n\t\t)\r\n\t)\r\n\r\n\t\r\n\r\n\treturn (\r\n\t\t<div>\r\n\t\t\t <div>\r\n\t\t\t\t<h1>\r\n\t\t\t\t\tSearch for the Supermarkets near you\r\n\t\t\t\t</h1>\r\n\t\t\t\t\t\r\n\t\t\t</div>\r\n\t\t\t <div style={{width:\"500px\"}}>\r\n\r\n\t\t\t\t<AsyncMap\r\n\t\t\t\t\tgoogleMapURL=\"https://maps.googleapis.com/maps/api/js?key=AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI&libraries=places\"\r\n\t\t\t\t\tloadingElement={\r\n\t\t\t\t\t <div style={{ height: `100%` }} />\r\n\t\t\t\t\t}\r\n\t\t\t\t\tcontainerElement={\r\n\t\t\t\t\t <div style={{ height: this.props.height }} />\r\n\t\t\t\t\t}\r\n\t\t\t\t\tmapElement={\r\n\t\t\t\t\t <div style={{ height: `100%` }} />\r\n\t\t\t\t\t}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\r\n\t \r\n\t)\r\n  }\r\n}\r\n\r\nexport default Map"]},"metadata":{},"sourceType":"module"}