{"version":3,"sources":["components/SearchShop/MarkerShop.js","image/basket.png","image/basketSelected.png","components/SearchShop/Map.js"],"names":["MarkerShop","_Component","props","_this","Object","C_Users_AlankHoang_Desktop_freecodeacademy_shoppingClient_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","this","C_Users_AlankHoang_Desktop_freecodeacademy_shoppingClient_node_modules_babel_runtime_helpers_esm_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_2__","C_Users_AlankHoang_Desktop_freecodeacademy_shoppingClient_node_modules_babel_runtime_helpers_esm_getPrototypeOf__WEBPACK_IMPORTED_MODULE_3__","call","onDblClick","marker","event","markerObject","markers1","filter","mark","_id","changeMarkerSelected","iconBasket","icon","basket","superMarket","markerSelected","basketSelected","C_Users_AlankHoang_Desktop_freecodeacademy_shoppingClient_node_modules_babel_runtime_helpers_esm_inherits__WEBPACK_IMPORTED_MODULE_4__","C_Users_AlankHoang_Desktop_freecodeacademy_shoppingClient_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__","key","value","getSuperMarkets","nextProps","nextState","console","log","_this2","map","react__WEBPACK_IMPORTED_MODULE_5___default","a","createElement","react_google_maps__WEBPACK_IMPORTED_MODULE_8__","position","lat","lng","bind","animation","window","google","maps","Animation","DROP","Component","connect","state","module","exports","Geocode","setApiKey","enableDebug","Map","updating_marker","moving","insideBound_bound","markers","bound","setState","input","maploading","insideBound","movePosition","check_markers1","array1","array2","arr1","arr2","elem","push","sort","toString","onPlaceSelected","place","undefined","name","fromAddress","then","response","_response$results$0$g","results","geometry","location","mapPosition","zoom","formatted_name","latValue","lngValue","mapmoved","JSON","stringify","getBounds","getCenter","maploaded","mapRef","onZoom","getZoom","shops","center","result","shop","markersInBound","parse","south","north","west","east","shopSelected","loading","prevProps","prevState","snapshot","AsyncMap","withScriptjs","withGoogleMap","react_google_maps__WEBPACK_IMPORTED_MODULE_6__","ref","defaultCenter","onDragEnd","onZoomChanged","react_google_autocomplete__WEBPACK_IMPORTED_MODULE_8___default","style","width","height","paddingLeft","margin","types","placeholder","_MarkerShop__WEBPACK_IMPORTED_MODULE_12__","googleMapURL","loadingElement","containerElement","display","flexDirection","mapElement","Fragment"],"mappings":"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","file":"static/js/5.3d99729d.chunk.js","sourcesContent":["import React, { Component } from 'react';\r\nimport basket from \"../../image/basket.png\"\r\nimport basketSelected from \"../../image/basketSelected.png\"\r\nimport { Marker,InfoWindow  } from \"react-google-maps\";\r\nimport {connect} from \"react-redux\"\r\nimport {getSuperMarkets,changeMarkerSelected} from \"../../actions/SuperMarketActions\"\r\nimport PropTypes from \"prop-types\"\r\n\r\nexport class MarkerShop extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t}\r\n\tcomponentDidMount(){\r\n\t\tthis.props.getSuperMarkets()\r\n\r\n\t}\r\n\tshouldComponentUpdate(nextProps, nextState){\r\n\t\tconsole.log(\"markerShop ShouldCOmponentUpdate\",nextProps,this.props)\r\n\t\tif(this.props.superMarket.markerSelected!==nextProps.superMarket.markerSelected){\r\n\t\t\tconsole.log(\"marker clicked\")\r\n\t\t\treturn true\t\r\n\t\t}else{\r\n\t\t\treturn false\t\r\n\t\t}\r\n\t}\r\n\tonDblClick = (marker,event)=>{\t\r\n\t\tvar markerObject = this.props.markers1.filter((mark)=>{\r\n\t\t\treturn mark._id=== marker\r\n\t\t})\r\n\t\tmarkerObject = markerObject[0]\r\n\t\tthis.props.changeMarkerSelected(markerObject)\r\n\t} \r\n\ticonBasket = (marker)=>{\r\n\t\tlet icon = basket\r\n\t\tif(this.props.superMarket.markerSelected!==null){\r\n\t\t\tif (this.props.superMarket.markerSelected._id===marker._id){\r\n\t\t\t\ticon = basketSelected\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn icon\t\r\n\t}\t  \t\t\r\n\trender(){\r\n\t\treturn(\r\n\t\t\tthis.props.markers1.map((marker) => {\t\t\t\t\r\n\t\t\treturn( \r\n\t\t\t\t<Marker\r\n\t\t\t\t\t\tkey={marker._id}\r\n\t\t\t\t\t\tposition={{ lat: marker.lat, lng: marker.lng }}\r\n\t\t\t\t\t\ticon ={this.iconBasket(marker)}\r\n\t\t\t\t\t\tonDblClick = {this.onDblClick.bind(this,marker._id)}\r\n\t\t\t\t\t\tanimation={window.google.maps.Animation.DROP}\r\n\t\t\t\t>\r\n\r\n\t\t\t\t</Marker>\r\n\t\t\t)\r\n\t\t\t\t\r\n\t\t})\r\n\r\n    \t)\r\n\r\n\t}\r\n\r\n\t}\r\n\r\n\r\n\r\nMarkerShop.propTypes = {\r\n\tgetSuperMarkets:PropTypes.func.isRequired,\r\n\tsuperMarket:PropTypes.object.isRequired,\r\n\tchangeMarkerSelected:PropTypes.func.isRequired,\r\n}\r\n\r\nconst mapStateToProps = (state)=>({\r\n\tsuperMarket:state.superMarket\r\n})\r\n\r\nexport default connect(mapStateToProps,{getSuperMarkets,changeMarkerSelected})(MarkerShop)","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAQAAADZc7J/AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QAAKqNIzIAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAAHdElNRQfjBREQNg4Ow2MEAAABw0lEQVRIx7XST0iUYRDH8c+uRpDQISOsKIhAD9WhdG9BEAUGnbsEER0CA29Bpw4hRGCnoD9KXYTsWtAhSSqIDrULIgWVGJ2CiMwyTd3ofTq0vL7tvrHvrjQPL8z8hvkyM++wSmsx7KBps80jRkR+uWd/84guV30XObSaUdqVXVvdNia8aKasNfaKTnrYYPWCK7k4OG3IRz8aAmw0vxLsFfQ12MF9H/Jx8MqingYBBcWVHfw0qZBIDuhKLRp1t+Jtt0mpNZEqOqPNAsjrtTMVMB0DCigmUyeEhu7xkkh7PiEUK9Ss1uO9meQIb80l1rhVn9aaoi8GBZDTbaw6/dhU7B9RFmreJ+sr+U7B2WrAoMiGjAMcFxwg/5dYlLMvI6AgMqFqyhL6dWcC9HpjrlrM+Zwyd/orO0V1B0HJHrszdbBkMU0eEHRk3ILaDniO22YyVI4bTgOMGXU45YBq7esfwH+zbW555nJ8d7DLHU+dt7Z+eZt3lpRExmNti1nfTApu1gccFRzDBcGOitYvKGDEcrKHfCogoKXyhYoWxVpQ19aZsuylyINY6zBj3mvBjSxL3Oy6Jy5qS2idRjxyzppm/so/7Tcq94+QjVQ+/AAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAxOS0wNS0xN1QxNDo1NDoxNCswMjowMCchyF0AAAAldEVYdGRhdGU6bW9kaWZ5ADIwMTktMDUtMTdUMTQ6NTQ6MTQrMDI6MDBWfHDhAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAABJRU5ErkJggg==\"","module.exports = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAMAAABEpIrGAAAAA3NCSVQICAjb4U/gAAAACXBIWXMAAADdAAAA3QFwU6IHAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAa1QTFRF////AACAAABVAACAMwBmKwCAIACAJwB2JACAIgB3IACAGgBzIwB0IAB1HQd1HAd1HgZ3HwV4HwV6HQV2HgR5HwR4HQR4HAR4HwN3HgN5HwN4HwN5HQN3HQN4HgN3HQV4HQV4HwV4HgV5HgR4HgR3HgR4HQR3HwR3HwR4HwR5HwR3HgN5HwN4HgN4HgN4HQN3HQN4HQV5HgV4HgR3HwR3HgR4HgR4HgR4HgR4HgR4HgR5HgR4HgR4RU+gaJPDYoa9caXNdq3ROz2VY0+mZFGoeLTTHgR4VW6vgXC7HgR4NC6PWXSzNC6OVW2wW3m1W3q2gcHbHgR4LiOIhcngTV6nS1umTzmYHgR4HgR4RE6ekIDFkYHFitTlHQR4HgR4jNjnJA5+HgR4erXVNjGPfrzZMy2NMimNMiqMkeHsHgV4HQV4MhmGHgV4LxaDHgR4HgR4LhaDk+TtLCCGLRSBHgR4KhuEHgR5HwV4JhOAHwV5JRJ/k+buHgR4HgR4lOfvHgR4HgR4keLsIAd6HgR4HgR4HwZ5Hwd5HgR4HgV4lOfvm4zMHgR4lObvlOfvm4zMlU76tgAAAIt0Uk5TAAIDBAUGCA0ODxAUFhgjJSsxMjQ7QkZISUxRUlhZXmBobHB3eHl6fH2FjZKVl5mcnaWoq6+wsbO0tbi5u7+/wMDAwcHBwcLCwsPDw8TExMTExsfHyMnJys7Ozs7P0NLS19jZ29ze39/f4OHh4uPk5eXl5ufo6e3w8PHx8fP09ff5+fr7/Pz8/v7+/tyk7M4AAAE2SURBVBgZlcGFWsIAFAbQH1QUEbG7u7u7xW7sTuzAFltBrtdndkNEPzannoNfpeUaoCjbZqsOgxJD7tVNCBTpHgugbG4Cyooean5QHApREh2uyjubhSiU2lne2C5EPrc9LO+4Ak7jyyzq73XrXmLBAWXBKe/5mplfh8/dTjtZMEKRcEqkeZbTQDo4BVEzy5k044PK2seCu/qWTwMseLkohUvHOgtWzunTwh0zb1AqXHLslyw1SOFwiaMZlmq0aeESSKNNUmuLcDshGdY4uNVa9FIafMmmACiKoroSiQh8k79nkcjAP/mnVCVoINJnlcd4QWLIvkWFEKi373coE55CyPjWZtUCiKVph2lTBQ/BZHxrtfoBiKEph8msgqcu+z4VQKA2Px1ROiR8kyvjvSHSZZRFq/A3788byH5ScK71AAAAAElFTkSuQmCC\"","import React, { Component } from 'react';\r\nimport { withGoogleMap, GoogleMap, withScriptjs, Marker,InfoWindow  } from \"react-google-maps\";\r\nimport Geocode from \"react-geocode\"\r\nimport Autocomplete from 'react-google-autocomplete';\r\nimport uuid from \"uuid\"\r\nimport {connect} from \"react-redux\"\r\nimport {getSuperMarkets,changeMarkerSelected} from \"../../actions/SuperMarketActions\"\r\nimport MarkerShop from \"./MarkerShop\"\r\nimport PropTypes from \"prop-types\"\r\n\r\n\r\nGeocode.setApiKey('AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI');\r\nGeocode.enableDebug();\r\n\r\n\r\nexport class Map extends Component {\r\n\tconstructor(props){\r\n\t\tsuper(props)\r\n\t\tthis.state = {\r\n\t\t\tbound:null,\r\n\t\t\tinput:\"\",\r\n\t\t\tmapPosition:{\r\n\t\t\t\tlat: this.props.center.lat,\r\n\t\t\t\tlng: this.props.center.lng\r\n\t\t\t},\r\n\t\t\tmovePosition:{\r\n\t\t\t\tlat:this.props.center.lat,\r\n\t\t\t\tlng:this.props.center.lng\t\t\r\n\t\t\t},\r\n\t\t\tmap:null,\r\n\t\t\tmarkers1:[],\r\n\t\t\tzoom:15,\r\n\t\t\tmoving:false,\r\n\t\t\tmaploading:false,\r\n\t\t}\r\n\t}\r\n\tcomponentDidMount(){\r\n\t\tthis.props.getSuperMarkets()\r\n\t\tthis.updating_marker()\r\n\r\n\t}\r\n\tupdating_marker = ()=>{\r\n\t\tif (this.state.moving===true){\r\n\t\t\tvar markers1 = this.insideBound_bound(this.props.superMarket.markers,this.state.bound)\r\n\t\t\tthis.setState({\r\n\t\t\t\tmarkers1:markers1,\r\n\t\t\t\tmoving:false,\r\n\t\t\t\tinput:false,\r\n\t\t\t\tmaploading:false,\r\n\r\n\t\t\t})\r\n\t\t}else{\r\n\t\t\tconsole.log(\"asdfasdfad\")\r\n\t\t\tmarkers1 = this.insideBound(this.props.superMarket.markers,this.state.movePosition)\r\n\t\t\tthis.setState({\r\n\t\t\t\tmarkers1:markers1,\r\n\t\t\t\tmoving:false,\r\n\t\t\t\tinput:false,\r\n\t\t\t\tmaploading:false,\r\n\r\n\t\t\t})\t\t\r\n\t\t}\r\n\t\t}\r\n\tshouldComponentUpdate( nextProps, nextState ){\t\r\n\t\tconsole.log(\"should Componeent update\", nextState, this.state,nextProps,this.props)\r\n\t\tif (this.check_markers1(nextState.markers1,this.state.markers1)===false){\r\n\t\t\tconsole.log(\"change\")\r\n\t\t\treturn true\r\n\t\t}\t\t\t\t\r\n\t\telse if(nextState.input===true){\r\n\t\t\tconsole.log(\"change position\")\r\n\t\t\treturn true\r\n\t\t}\r\n\t\telse if(nextProps.shopSelected !== this.props.shopSelected){\r\n\t\t\tconsole.log(\"new marker selected\")\r\n\t\t\treturn false\r\n\t\t}\r\n\t\telse if (this.check_markers1(nextProps.superMarket.markers,this.props.superMarket.markers)===false){\r\n\t\t\tconsole.log(\"change props markers\")\r\n\t\t\treturn true\r\n\t\t}\r\n\t\telse if (this.check_markers1(nextState.markers1,this.state.markers1)===true){\r\n\t\t\tconsole.log(\"no change\")\r\n\t\t\treturn false\r\n\t\t}\r\n\t\telse if(nextProps.loading===true||this.props.loading===true){\r\n\t\t\tconsole.log(\"loading\")\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\tcomponentDidUpdate(prevProps, prevState, snapshot){\r\n\t\tconsole.log(\"componentDidUpdate\",prevState,this.state,prevProps,this.props)\r\n\t\tthis.updating_marker()\r\n\r\n\t}\r\n\tcheck_markers1=(array1,array2) => {\r\n\t\tvar arr1 = []\r\n\t\tvar arr2 = []\r\n\t\tarray1.map((elem)=>{\r\n\t\t\tarr1.push(elem._id)\r\n\t\t})\r\n\t\tarray2.map((elem)=>{\r\n\t\t\tarr2.push(elem._id)\r\n\t\t})\r\n\t\tif (arr1.sort().toString()==arr2.sort().toString()){\t\r\n\t\t\treturn true\r\n\t\t}else \r\n\t\t\t{return false}\r\n\t\t}\r\n\tonPlaceSelected = ( place,event ) => {\r\n\t\tif (place.name!==undefined){\r\n\t\t\tGeocode.fromAddress(place.name).then(\r\n\t\t\t\tresponse => {\r\n    \t\t\tconst { lat, lng } = response.results[0].geometry.location\r\n    \t\t\tvar markers1 = this.insideBound(this.props.superMarket.markers,response.results[0].geometry.location)\r\n    \t\t\tif (lat ===undefined){\r\n    \t\t\t\treturn null\r\n    \t\t\t}\r\n    \t\t\tthis.setState({\r\n\t\t\t\t\tmapPosition: {\r\n\t\t\t\t\t\tlat: lat,\r\n\t\t\t\t\t\tlng: lng\r\n\t\t\t\t\t},\r\n\t\t\t\t\tmovePosition: {\r\n\t\t\t\t\t\tlat: lat,\r\n\t\t\t\t\t\tlng: lng\r\n\t\t\t\t},\r\n\t\t\t\t\tzoom:11,\r\n\t\t\t\t\tmarkers1:markers1,\r\n\t\t\t\t\tinput:true,\r\n\t\t\t\t\tmoving:false,\r\n\t\t\t})\r\n    \t\t})\r\n\t\t}\r\n\t\telse{\r\n\t\t\tconst name = place.formatted_name,\r\n\t\t\tlatValue = place.geometry.location.lat(),\r\n\t\t\tlngValue = place.geometry.location.lng();\r\n\t\t\tvar markers1 = this.insideBound(this.props.superMarket.markers,place.geometry.location)\r\n\t\t\t// Set these values in the state.\r\n\t\t\tthis.setState({\r\n\t\t\t\tmapPosition: {\r\n\t\t\t\t\tlat: latValue,\r\n\t\t\t\t\tlng: lngValue\r\n\t\t\t\t},\r\n\t\t\t\tmovePosition: {\r\n\t\t\t\t\tlat: latValue,\r\n\t\t\t\t\tlng: lngValue\r\n\t\t\t\t},\r\n\t\t\t\tzoom:11,\r\n\t\t\t\tmarkers1:markers1,\r\n\t\t\t\tinput:true,\r\n\t\t\t\tmoving:false,\r\n\t\t\t})\r\n\t\t}\r\n\tthis.props.changeMarkerSelected(null)\r\n\treturn\r\n\t};\r\n\tmapmoved=()=>{\r\n\t\tvar markers1 = this.insideBound_bound(this.props.superMarket.markers,JSON.stringify(this.state.map.getBounds()))\r\n\t\tthis.setState({\r\n\t\t\tbound:JSON.stringify(this.state.map.getBounds()),\r\n\t\t\tmovePosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\t\t\tmapPosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\t\t\tmarkers1:markers1 ,\r\n\t\t\tmoving:true\t\r\n\t\t})\r\n\t}\r\n\tmaploaded=(mapRef)=>{\r\n\t\tif(!mapRef){\r\n\t\t\treturn\r\n\t\t}\r\n\t\tthis.setState({\r\n\t\t\tmap:mapRef,\r\n\t\t\tmaploading:true})\t\r\n\t}\r\n\tonZoom = ()=>{\r\n\t\tvar markers1 = this.insideBound_bound(this.props.superMarket.markers,JSON.stringify(this.state.map.getBounds()))\r\n\t\tthis.setState({\r\n\t\t\tbound:JSON.stringify(this.state.map.getBounds()),\r\n\t\t\tmovePosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\t\t\tmapPosition: {\r\n\t\t\t\tlat: this.state.map.getCenter().lat(),\r\n\t\t\t\tlng: this.state.map.getCenter().lng()\r\n\t\t\t},\r\n\t\t\tmarkers1:markers1,\r\n\t\t\tzoom:this.state.map.getZoom(),\r\n\t\t\tmoving:true\t\r\n\t\t})\r\n\t}\r\n\tinsideBound = (shops,center)=>{\r\n\t\tif (center!=null&&shops!=null){\r\n\t\t\tvar result = []\r\n\t\t\tshops.map((shop)=>{\r\n\t\t\t\tif (shop.lat>center.lat-0.2 && shop.lat<center.lat+0.2 && shop.lng>center.lng-0.2 && shop.lng<center.lng+0.2){\r\n\t\t\t\t\tresult.push(shop)}\t\r\n\t\t\t})\r\n\t\t\tthis.props.markersInBound(result)\t\t\r\n\t\t\treturn result\t\t\t\r\n\t\t}else{return []}\t\t\r\n\t}\r\n\tinsideBound_bound = (shops,bound)=>{\r\n\t\tif (bound!=null&&shops!=null){\r\n\t\t\tbound = JSON.parse(bound)\r\n\t\t\tvar result = []\t\r\n\t\t\tshops.map((shop)=>{\r\n\t\t\t\tif (shop.lat>bound.south && shop.lat<bound.north && shop.lng>bound.west && shop.lng<bound.east){\r\n\t\t\t\t\tresult.push(shop)}\t\r\n\t\t\t})\t\t\r\n\t\t\tthis.props.markersInBound(result)\t\t\r\n\t\t\treturn result\t\t\t\r\n\t\t}else{return []}\r\n\t}\r\n\t\r\n\trender() {\t\r\n\tconst AsyncMap = withScriptjs(\r\n\t\twithGoogleMap(\r\n\t\t\tprops => (\r\n\t\t\t\t<GoogleMap \r\n\t\t\t\tref = {this.maploaded}\r\n\t\t\t\tzoom={this.state.zoom}\r\n\t\t\t\tdefaultCenter={{ lat: this.props.lat, lng: this.props.lng }}\r\n\t\t\t\tcenter={{ lat: this.state.mapPosition.lat, lng: this.state.mapPosition.lng }}\r\n\t\t\t\tonDragEnd={this.mapmoved}\r\n\t\t\t\tonZoomChanged = {this.onZoom}\r\n\t\t\t\t>\r\n\t\t\t\t\t<Autocomplete\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\twidth: '200%',\r\n\t\t\t\t\t\theight: '40px',\r\n\t\t\t\t\t\tpaddingLeft: '16px',\r\n\t\t\t\t\t\tmargin:\"2px auto 20px auto\",\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tonPlaceSelected={ this.onPlaceSelected }\r\n\t\t\t\t\t\ttypes={['(regions)']}\r\n\t\t\t\t\t\tplaceholder={\"Enter and select location\"}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<MarkerShop\r\n\t\t\t\t\t\tmarkers1={this.state.markers1}/>\r\n\t\t\t\t</GoogleMap>\r\n\t\t\t)\r\n\t\t)\r\n\t)\r\n\tlet map\r\n\tmap =  <div style={{width:\"100%\"}} >\r\n\t\t\t<AsyncMap\r\n\t\t\t\tgoogleMapURL= \"https://maps.googleapis.com/maps/api/js?key=AIzaSyBiffp6dvrIk_EWQHzXk05VzFKb5tioZeI&libraries=places\"\r\n\t\t\t\tloadingElement={\r\n\t\t\t\t <div style={{ height: `100%` }} />\r\n\t\t\t\t}\r\n\t\t\t\tcontainerElement={\r\n\t\t\t\t <div style={{ height: this.props.height,\r\n  \t\t\t\t\t\t\t\tdisplay: \"flex\",\r\n  \t\t\t\t\t\t\t\tflexDirection: \"column-reverse\"}} />\r\n\t\t\t\t}\r\n\t\t\t\tmapElement={\r\n\t\t\t\t <div style={{ height: `100%` }} />\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\treturn (\r\n\t\t<React.Fragment>\r\n\t\t\t{map}\r\n\t\t</React.Fragment> \r\n\t)\r\n  }\r\n}\r\n\r\nMap.propTypes = {\r\n\tgetSuperMarkets:PropTypes.func.isRequired,\r\n\tsuperMarket:PropTypes.object.isRequired,\r\n\tchangeMarkerSelected:PropTypes.func.isRequired\t\r\n}\r\n\r\nconst mapStateToProps = (state)=>({\r\n\tsuperMarket:state.superMarket\r\n})\r\n\r\nexport default connect(mapStateToProps,{getSuperMarkets,changeMarkerSelected})(Map)"],"sourceRoot":""}